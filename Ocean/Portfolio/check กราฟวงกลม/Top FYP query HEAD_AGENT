select agent_name as agentName, agent_code_7 as agentCode7, premium_portfolio as premiumPortfolio, position_group as positionGroup,position  
					  from    
					  (    
					  select agent_name, agent_code_7, premium_portfolio,  
					   position_group, position    
					  from (  
					   select agent_code_7, agent_name, premium_portfolio, position_group, position,  
					   ROW_NUMBER () OVER (ORDER BY premium_portfolio desc, agent_code_7) as row_number  
					   from (    
					   select a.agent_code_7, a.agent_name, a.recruiter_code_7, a.premium_portfolio,  
					   a.position_group, a.position    
					   from agpt_agent_income a    
					   where a.period = :period  
					   and a.branch_code = :branchCode    
					   and a.recruiter_code_7 = :agentCode  
					   and (a.position_group = 'ตท.' or a.position_group = 'ตท.กง.')     
					   ) aa     
					   ) bb  
					  where bb.row_number <= 5    
					  union all    
					  select 'คนอื่นๆ รวมกัน'  as agent_name,   
					   null as agent_code_7,     
					   sum(premium_portfolio) as premium_portfolio,  
					   null as position_group, null as position    
					  from (  
					   select agent_code_7, agent_name, premium_portfolio, position_group, position,  
					   ROW_NUMBER () OVER (ORDER BY premium_portfolio desc, agent_code_7) as row_number  
					   from (    
					   select a.agent_code_7, a.agent_name, a.recruiter_code_7, a.premium_portfolio,  
					   a.position_group, a.position    
					   from agpt_agent_income a    
					   where a.period = :period  
					   and a.branch_code = :branchCode    
					   and a.recruiter_code_7 = :agentCode  
					   and (a.position_group = 'ตท.' or a.position_group = 'ตท.กง.')     
					   ) aa     
					   ) bb  
					  where bb.row_number > 5    
					  ) cc    
					  where cc.premium_portfolio is not null
