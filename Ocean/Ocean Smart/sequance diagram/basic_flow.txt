sequenceDiagram
    participant u as user
    participant a as app
    participant d as local db
    participant e as E-App
    
    u->>u: input login
    u->>a: click login 
    a->>a: do some thing for check user/password
    a->>u: redirect to customer input page
    u->>u: input customer data
    u->>a: click Traditional
    a->>d: request product data
    d->>a: return product data
    a->>u: redirect to sales page
    rect rgb(210, 255, 250)
        Note over u,a: การเลือกแบบประกันหลัก
        u->>u: user เลือก product ของ กรมธรรม์หลัก
        loop change เงินเอาประกัน
            u->>a: user เปลี่ยนจำนวนเงินเอาประกัน
            a->>a: check เงินเอาประกัน min, max
            alt < min
                a->>u: alert เงินเอาประกันตำกว่าทุนประกันขึ้นต่ำ
            else > max
                a->>u: alert เงินเอาประกันมากกว่าทุนประกันขึ้นสูง
            end 
            a->>a: คำนวนเบี้ย
            a->>u: แสดงเบี้ย
        end
    end
    rect rgb(230, 245, 255)
        Note over u,a: การเลือกแบบประกัน PA
        u->>u: user เลือก product ของ PA
        loop change เงินเอาประกัน
            u->>a: user เปลี่ยนจำนวนเงินเอาประกัน
            a->>a: check เงินเอาประกัน min, max
            alt < min
                a->>u: alert เงินเอาประกันตำกว่าทุนประกันขึ้นต่ำ
            else > max
                a->>u: alert เงินเอาประกันมากกว่าทุนประกันขึ้นสูง
            end
            a->>a: คำนวนเบี้ย
            a->>u: แสดงเบี้ย 
        end
        
    end

    rect rgb(230, 235, 235)
        Note over u,a: การเลือก rider
        u->>a: เปลี่ยน รายละเอียด กธ. หลัก
        a->>d: request rider by condition
        d->>a:send rider data by condition
        a->>u: update rider data
        u->>a: ทำการเลือก rider และใส่ ทุน
        a->>u: คำนวนเบี้ย
    end

    rect rgb(220, 235, 235)
        Note over u,a: ตรวจสภาวะ
    end

    rect rgb(250, 225, 235)
        Note over u,a: สร้างใบเสนอขาย
        u->>a: click สร้างใบเสนอขาย/E-App
        a->>a: check ว่ามีการเลือก แบบประกันหลัก หรือ PA หรือยัง
        alt ยังไม่มีการเลือกแบบประกันหลัก หรือ PA
            a->>u: alert กรุณาเลือกแบบประกันหลัก หรือ PA
        else มีการเลือกแบบประกันหลัก หรือ PA
            a->>e: send customer data to create ใบคำขอ
            e->>a: receive เลขที่ใบคำขอ
            a->>e: request open ใบคำขอ ของ E-App
            e->>u: redirect to page ใบคำขอ ของ E-App
        end 
        
    end
