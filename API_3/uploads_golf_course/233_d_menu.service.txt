import { Injectable } from '@angular/core';
import { Headers, Http } from '@angular/http';

import 'rxjs/add/operator/toPromise';

import { Menu } from './menus';
import { MenuData } from './menus';
import { Datass } from './menus';
import { Menus } from './menus';


@Injectable()
export class MenuService {

  private APIUrl = 'http://localhost/ctgAPI/API/index.php/';
  private headers = new Headers({'Content-Type': 'application/json'});

  MENUES: Promise<Menus[]>;


  constructor(private http: Http) { }

     getMenu(token: string): Promise<Menu> {
    //console.log('*1* ' + this.MENUES);
    
    return this.http
    .post(this.APIUrl + 'Menus', JSON.stringify({token: token}), {headers: this.headers})
    .toPromise()
    .then(res =>  res.json().data as Menu )
    .catch(this.handleError);

   
  }  
 
   /*  getMenu(token: string):any {
     let a :Menu = new Menu();
     a.path = "pages";
     a.children =  [];
  
    //let menuJson : string = '';
    //return this.PAGES_MENU2;
    let datam : Menus = new Menus();    
    datam.title = "Welcome";
    datam.icon = null;
    datam.order = 1;
    datam.hidden = null;
    let datads : Datass = new Datass();
    datads.menu = datam; 
    let data : MenuData = new MenuData();
    data.path = "defaultpage";
    data.data = datads;

    let datam2 : Menus = new Menus();    
    datam2.title = "golf";
    datam2.icon = null;
    datam2.order = 1;
    datam2.hidden = null;
    let datads2 : Datass = new Datass();
    datads2.menu = datam; 
    let data2 : MenuData = new MenuData();
    data2.path = "home";
    data2.data = datads;
    data.children = [];
    data.children.push(data2);

    a.children.push(data);

    let b : any[] = [];
    b.push(a);
    console.log("["+ JSON.stringify(a) +"]" );
    return b ;
  }   */
 

  

  private handleError(error: any): Promise<any> {
    console.error('An error occurred', error);
    return Promise.reject(error.message || error);
  }

}
